<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Login - Comunidad Piura</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- 👈 importante -->
  <link rel="icon" type="image/png" href="https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcReMJly0vwqQtfircDFDpZwXu18Sd3bSMIOsRRLQyJ0irbFg3KC">
  <style>
  body {
    min-height: 100vh;
    background: linear-gradient(135deg, #000000, #1c1c1c);
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
  }

  .login-container {
    display: none;
    background: rgba(20, 20, 20, 0.95);
    padding: 30px;
    border-radius: 12px;
    width: 100%;
    max-width: 380px;
    text-align: center;
    box-shadow: 0 0 20px rgba(255, 0, 0, 0.5);
    animation: fadeIn 0.8s ease-in-out;
  }

  /* 🔥 En celular: pantalla completa */
  @media (max-width: 768px) {
    body {
      padding: 0;
    }
    .login-container {
      max-width: 100%;
      width: 100%;
      height: 100vh;      /* ocupa toda la pantalla */
      border-radius: 0;   /* sin esquinas redondeadas */
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    .login-container h1 {
      font-size: 20px;
    }
    input, .btn {
      font-size: 16px;   /* más grande para dedos */
      padding: 15px;
    }
    .logo {
      width: 100px;
      margin: 10px auto;
    }
  }
</style>

</head>
<body>
   <!-- Loader -->

 <div id="loader">

  <img src="ComunidadPiura-removebg-preview.png" alt="Logo">

 </div>



 <!-- Caja Login -->

 <div id="loginBox" class="login-container">

  <h1>Bienvenido a la</h1>

  <img src="ComunidadPiura-removebg-preview.png" class="logo">



  <form id="loginForm">

   <input type="email" id="loginEmail" placeholder="Correo electrónico" required>

   <div style="position: relative;">

    <input type="password" id="loginPassword" placeholder="Contraseña" required>

    <span onclick="togglePassword('loginPassword')" 

       style="position:absolute; right:10px; top:50%; transform:translateY(-50%); cursor:pointer; color:#e50914;">👁️</span>

   </div>

    

   <p id="error"></p>

   <button type="submit" class="btn btn-login">Ingresar</button>

  </form>



  <div class="toggle" onclick="showRegister()">¿No tienes cuenta? Regístrate</div>

  <div class="toggle" onclick="resetPassword()">¿Olvidaste tu contraseña?</div>

 </div>



 <!-- Caja Registro -->

 <div id="registerBox" class="login-container">

  <h1>Crear Cuenta</h1>

  <img src="https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcReMJly0vwqQtfircDFDpZwXu18Sd3bSMIOsRRLQyJ0irbFg3KC" class="logo">



  <form id="registerForm">

   <input type="email" id="registerEmail" placeholder="Correo electrónico" required>

   <input type="password" id="registerPassword" placeholder="Contraseña" required oninput="checkStrength(this.value)">

   <div id="strengthBar" style="height:6px; border-radius:3px; margin-top:5px; background:#222;"></div>

   <p id="errorRegister"></p>

   <button type="submit" class="btn btn-register">Crear Cuenta</button>

  </form>



  <div class="toggle" onclick="showLogin()">¿Ya tienes cuenta? Inicia sesión</div>

 </div>



 <!-- Firebase -->

 <script type="module">

  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";

  import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, sendPasswordResetEmail, setPersistence, browserLocalPersistence } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";



  const firebaseConfig = {

   apiKey: "AIzaSyD33P7MvrIGbNo1lRSbZBXb4hZoQ_dkjVg",

   authDomain: "comunidadpiura-fed53.firebaseapp.com",

   projectId: "comunidadpiura-fed53",

   storageBucket: "comunidadpiura-fed53.firebasestorage.app",

   messagingSenderId: "113288016871",

   appId: "1:113288016871:web:f94f6c6490bcdbca0bc342",

   measurementId: "G-68EYEMSET9"

  };



  const app = initializeApp(firebaseConfig);

  const auth = getAuth(app);



  // Login

  document.getElementById("loginForm").addEventListener("submit", (e) => {

   e.preventDefault();

   const email = document.getElementById("loginEmail").value;

   const password = document.getElementById("loginPassword").value;

   const remember = document.getElementById("rememberMe").checked;



   if (remember) {

    setPersistence(auth, browserLocalPersistence).then(() => {

     return signInWithEmailAndPassword(auth, email, password);

    }).then(() => {

     window.location.href = "home.html";

    }).catch(err => {

     document.getElementById("error").style.display = "block";

     document.getElementById("error").innerText = err.message;

    });

   } else {

    signInWithEmailAndPassword(auth, email, password)

     .then(() => window.location.href = "home.html")

     .catch(err => {

      document.getElementById("error").style.display = "block";

      document.getElementById("error").innerText = err.message;

     });

   }

  });



  // Registro

  document.getElementById("registerForm").addEventListener("submit", (e) => {

   e.preventDefault();

   const email = document.getElementById("registerEmail").value;

   const password = document.getElementById("registerPassword").value;

   createUserWithEmailAndPassword(auth, email, password)

    .then(() => { window.location.href = "home.html"; })

    .catch((error) => {

     document.getElementById("errorRegister").style.display = "block";

     document.getElementById("errorRegister").innerText = error.message;

    });

  });



  // Pantallas

  window.showRegister = function() {

   document.getElementById("loginBox").style.display = "none";

   document.getElementById("registerBox").style.display = "block";

  }

  window.showLogin = function() {

   document.getElementById("registerBox").style.display = "none";

   document.getElementById("loginBox").style.display = "block";

  }



  // Loader

  window.onload = function() {

   setTimeout(() => {

    const loader = document.getElementById('loader');

    loader.style.opacity = "0";

    setTimeout(() => {

     loader.style.display = 'none';

     document.getElementById('loginBox').style.display = 'block';

    }, 1000);

   }, 2000);

  }



  // Mostrar/ocultar contraseña

  window.togglePassword = function(id) {

   const input = document.getElementById(id);

   input.type = input.type === "password" ? "text" : "password";

  }



  // Fuerza de contraseña

  window.checkStrength = function(password) {

   const bar = document.getElementById("strengthBar");

   let strength = 0;

   if (password.length > 5) strength++;

   if (/[A-Z]/.test(password)) strength++;

   if (/[0-9]/.test(password)) strength++;

   if (/[^A-Za-z0-9]/.test(password)) strength++;



   const colors = ["#ef4444","#f97316","#facc15","#22c55e"];

   bar.style.background = colors[strength-1] || "#222";

   bar.style.width = (strength*25) + "%";

  }



  // Recuperar contraseña

  window.resetPassword = function() {

   const email = prompt("Ingresa tu correo para recuperar tu contraseña:");

   if (email) {

    sendPasswordResetEmail(auth, email)

     .then(() => alert("Se ha enviado un enlace de recuperación a tu correo."))

     .catch(err => alert(err.message));

   }

  }

 </script>
</body>
</html>
